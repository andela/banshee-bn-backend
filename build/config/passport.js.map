{"version":3,"sources":["../../src/config/passport.js"],"names":["passport","require","LocalStrategy","Strategy","mongoose","User","model","use","usernameField","passwordField","email","password","done","findOne","then","user","validPassword","errors","catch"],"mappings":";;AAAA,IAAMA,WAAWC,QAAQ,UAAR,CAAjB;AACA,IAAMC,gBAAgBD,QAAQ,gBAAR,EAA0BE,QAAhD;AACA,IAAMC,WAAWH,QAAQ,UAAR,CAAjB;AACA,IAAMI,OAAOD,SAASE,KAAT,CAAe,MAAf,CAAb;;AAEAN,SAASO,GAAT,CACI,IAAIL,aAAJ,CACI;AACIM,mBAAe,aADnB;AAEIC,mBAAe;AAFnB,CADJ,EAKI,UAASC,KAAT,EAAgBC,QAAhB,EAA0BC,IAA1B,EAAgC;AAC5BP,SAAKQ,OAAL,CAAa,EAAEH,OAAOA,KAAT,EAAb,EACKI,IADL,CACU,UAASC,IAAT,EAAe;AACjB,YAAI,CAACA,IAAD,IAAS,CAACA,KAAKC,aAAL,CAAmBL,QAAnB,CAAd,EAA4C;AACxC,mBAAOC,KAAK,IAAL,EAAW,KAAX,EAAkB;AACrBK,wBAAQ,EAAE,qBAAqB,YAAvB;AADa,aAAlB,CAAP;AAGH;;AAED,eAAOL,KAAK,IAAL,EAAWG,IAAX,CAAP;AACH,KATL,EAUKG,KAVL,CAUWN,IAVX;AAWH,CAjBL,CADJ","file":"passport.js","sourcesContent":["const passport = require(\"passport\");\nconst LocalStrategy = require(\"passport-local\").Strategy;\nconst mongoose = require(\"mongoose\");\nconst User = mongoose.model(\"User\");\n\npassport.use(\n    new LocalStrategy(\n        {\n            usernameField: \"user[email]\",\n            passwordField: \"user[password]\"\n        },\n        function(email, password, done) {\n            User.findOne({ email: email })\n                .then(function(user) {\n                    if (!user || !user.validPassword(password)) {\n                        return done(null, false, {\n                            errors: { \"email or password\": \"is invalid\" }\n                        });\n                    }\n\n                    return done(null, user);\n                })\n                .catch(done);\n        }\n    )\n);\n"]}